<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dark Horse Investment Group â€” Portfolio</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: seperate; border spacing: 0; width: 100%;
           margin-top: 20px; border-radius: 6px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #f4f4f4; }
    tfoot { font-weight: bold; background-color: #eaeaea; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1 style="text-align: center;">Dark Horse Investment Group -- Portfolio</h1>
  <table id="portfolio">
    <thead>
      <tr>
        <th>Symbol</th>
        <th>Shares</th>
        <th>Price</th>
        <th>Market Value</th>
        <th>Cost Basis</th>
        <th>Gain/Loss</th>
        <th>% Gain/Loss</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr>
        <td><strong>Total</strong></td>
        <td>-</td>
        <td>-</td>
        <td id="totalValue">$0.00</td>
        <td id="totalCost">$0.00</td>
        <td id="totalGain">$0.00</td>
        <td id="totalPercentGain">0.00%</td>
      </tr>
    </tfoot>
  </table>
  <canvas id="industryChart" width="400" height="400" style="max-width: 600px; margin: 40px auto; display: block;"></canvas>

  <script>
    const apiKey = 'YOUR_API_KEY_HERE';

    const portfolio = [
      { symbol: "AAPL", shares: 1.0083, costBasis: 176.04 },
      { symbol: "AMZN", shares: 3, costBasis: 396.36 },
      { symbol: "ARM", shares: 3, costBasis: 224.75 },
      { symbol: "BABA", shares: 2, costBasis: 144.80 },
      { symbol: "BIRK", shares: 2, costBasis: 89.31 },
      { symbol: "CAT", shares: 1, costBasis: 351.60 },
      { symbol: "CRWD", shares: 1, costBasis: 309.50 },
      { symbol: "HWM", shares: 4.0207, costBasis: 184.24 },
      { symbol: "JPM", shares: 2.0677, costBasis: 307.32 },
      { symbol: "KKR", shares: 1.0029, costBasis: 151.39 },
      { symbol: "META", shares: 1, costBasis: 438.23 },
      { symbol: "NVDA", shares: 10.0042, costBasis: 484.31 },
      { symbol: "NVO", shares: 3, costBasis: 375.84 },
      { symbol: "RIOT", shares: 7, costBasis: 72.80 },
      { symbol: "TSLA", shares: 1, costBasis: 243.39 },
      { symbol: "UNH", shares: 1.024, costBasis: 528.73 },
      { symbol: "WMT", shares: 9.1853, costBasis: 485.87 },
      { symbol: "BTC", shares: 1, costBasis: 24.48 },
      { symbol: "CIBR", shares: 4, costBasis: 221.40 },
      { symbol: "ETH", shares: 1, costBasis: 28.03 },
      { symbol: "ETHE", shares: 10, costBasis: 252.27 },
      { symbol: "GBTC", shares: 5, costBasis: 220.30 },
      { symbol: "IWM", shares: 2, costBasis: 408.62 },
      { symbol: "KWEB", shares: 18, costBasis: 434.76 },
      { symbol: "SOXX", shares: 3, costBasis: 752.55 },
      { symbol: "VNQ", shares: 3, costBasis: 270.23 },
      { symbol: "VTV", shares: 3.0703, costBasis: 495.90 },
      { symbol: "VUG", shares: 2.01, costBasis: 691.19 },
      { symbol: "XME", shares: 3.017, costBasis: 182.41 }
    ];

    const cashPosition = { symbol: "CASH", shares: 0, costBasis: 407.36, price: 1 };

    async function fetchPrice(symbol) {
      const response = await fetch(`https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${apiKey}`);
      const data = await response.json();
      return data.c;
    }

    async function updatePortfolio() {
      const tbody = document.querySelector("#portfolio tbody");
      tbody.innerHTML = "";

      let totalMarketValue = 0;
      let totalCostBasis = 0;

      for (const stock of portfolio) {
        const price = await fetchPrice(stock.symbol);
        const marketValue = price * stock.shares;
        stock.lastMarketValue = marketValue;
        const gain = marketValue - stock.costBasis;

        totalMarketValue += marketValue;
        totalCostBasis += stock.costBasis;

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${stock.symbol}</td>
          <td>${stock.shares.toFixed(4)}</td>
          <td>$${price.toFixed(2)}</td>
          <td>$${marketValue.toFixed(2)}</td>
          <td>$${stock.costBasis.toFixed(2)}</td>
          <td style="color: ${gain >= 0 ? 'green' : 'red'};">$${gain.toFixed(2)}</td>
          <td style="color: ${gain >= 0 ? 'green' : 'red'};">${((gain / stock.costBasis) * 100).toFixed(2)}%</td>
        `;
        tbody.appendChild(row);
      }

      // Add cash row
      totalMarketValue += cashPosition.costBasis;
      totalCostBasis += cashPosition.costBasis;

      const cashRow = document.createElement("tr");
      cashRow.innerHTML = `
        <td>${cashPosition.symbol}</td>
        <td>-</td>
        <td>-</td>
        <td>$${cashPosition.costBasis.toFixed(2)}</td>
        <td>$${cashPosition.costBasis.toFixed(2)}</td>
        <td style="color: gray;">$0.00</td>
      `;
      tbody.appendChild(cashRow);

      // Update total row
      const totalGain = totalMarketValue - totalCostBasis;
      document.getElementById("totalValue").textContent = `$${totalMarketValue.toFixed(2)}`;
      document.getElementById("totalCost").textContent = `$${totalCostBasis.toFixed(2)}`;
      document.getElementById("totalGain").textContent = `$${totalGain.toFixed(2)}`;
      document.getElementById("totalGain").style.color = totalGain >= 0 ? 'green' : 'red';
      const totalPercentGain = (totalGain / totalCostBasis) * 100;
      document.getElementById("totalPercentGain").textContent = `${totalPercentGain.toFixed(2)}%`;
      document.getElementById("totalPercentGain").style.color = totalGain >= 0 ? 'green' : 'red';
    }

  const industryMap = {
      AAPL: "Technology",
      AMZN: "Consumer Discretionary",
      ARM: "Technology",
      BABA: "Consumer Discretionary",
      BIRK: "Consumer Discretionary",
      CAT: "Industrials",
      CRWD: "Technology",
      HWM: "Industrials",
      JPM: "Financials",
      KKR: "Financials",
      META: "Technology",
      NVDA: "Technology",
      NVO: "Healthcare",
      RIOT: "Technology",
      TSLA: "Consumer Discretionary",
      UNH: "Healthcare",
      WMT: "Consumer Staples",
      BTC: "Cryptocurrency",
      CIBR: "ETF",
      ETH: "Cryptocurrency",
      ETHE: "Cryptocurrency",
      GBTC: "Cryptocurrency",
      IWM: "ETF",
      KWEB: "ETF",
      SOXX: "ETF",
      VNQ: "Real Estate",
      VTV: "ETF",
      VUG: "ETF",
      XME: "Materials"
    };
    
  function renderIndustryChart(dataByIndustry) {
    const ctx = document.getElementById("industryChart").getContext("2d");
    const labels = Object.keys(dataByIndustry);
    const data = Object.values(dataByIndustry);
  
    new Chart(ctx, {
      type: "pie",
      data: {
        labels: labels,
        datasets: [{
          label: "Industry Allocation",
          data: data,
          backgroundColor: [
            "#4caf50", "#2196f3", "#ff9800", "#9c27b0", "#f44336",
            "#3f51b5", "#00bcd4", "#795548", "#8bc34a", "#ff5722"
          ]
        }]
      },
      options: {
        plugins: {
          legend: {
            position: "bottom"
          }
        }
      }
    });
  }

    const industryTotals = {};

    for (const stock of portfolio) {
      const industry = industryMap[stock.symbol] || "Other";
      industryTotals[industry] = (industryTotals[industry] || 0) + (stock.lastMarketValue || 0);
    }

    renderIndustryChart(industryTotals);

    
    updatePortfolio();
  </script>
</body>
</html>
